#!/bin/bash
# Takes an optional argument for a root directory builds callgraph for all APKs in current directory or subdirectories
# Requires Androguard to be installed
# See info on the androguard cg command at https://androguard.readthedocs.io/en/latest/tools/androcg.html
for apkPath in `find ${1:-'.'} -name "*.apk" -type f`; do
    gmlPath=${apkPath%.*}.gml
    echo $gmlPath
    if [ -f $gmlPath ]; then
        echo "$gmlPath already exists! Skipping"
    else 
        androguard cg $apkPath -o $gmlPath
    fi
done